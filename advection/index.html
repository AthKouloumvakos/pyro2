<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>
<HEAD>
  <TITLE>pyro: advection</TITLE> 

  <link rel="stylesheet" type="text/css" href="../hydro.css">
  <link rel="stylesheet" type="text/css" href="./adv.css">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">

</HEAD> 

<body id="advection">

<!-- HEADER ............................................................. -->
<!-- to do highlighting:

http://hicksdesign.co.uk/journal/highlighting-current-page-with-css

http://www.richnetapps.com/automatically_highlight_current_page_in/

-->


<div id="header2">
  <h1>hydro by example</h1><br>
  <h3>A simple python-based tutorial on computational methods for hydrodynamics</h3>
</div>

<div id="subhead">
  <h2><a href="/pyro2/index.html" id="intronav">intro</a></h2> &bull;
  <h2><a href="/pyro2/design" id="designnav">design</a></h2> &bull;
  <h2><a href="/pyro2/grids" id="gridnav">grids</a></h2> &bull;
  <h2><a href="/pyro2/advection" id="advectnav">advection</a></h2> &bull;
  <h2><a href="/pyro2/compressible" id="compnav">compressible</a></h2> &bull;
  <h2><a href="/pyro2/multigrid" id="mgnav">multigrid</a></h2> &bull;
  <h2><a href="/pyro2/diffusion" id="diffnav">diffusion</a></h2> &bull;
  <h2><a href="/pyro2/incompressible" id="incompnav">incompressible</a></h2> &bull;
  <h2><a href="/pyro2/lm_atm" id="lmatmnav">low Mach</a></h2>  &nbsp;|&nbsp;

  <h2><a href="/pyro2/analysis" id="annav">analysis</a></h2> &nbsp;|&nbsp;

  <h2><a href="/pyro2/download" id="dlnav">download</a></h2> 

</div>




<!-- MAIN ............................................................... -->
<div id="main">


<P><H2>&lowast; Advection solver</H2>

<p>The linear advection equation provides a good basis for understanding the
methods used for compressible hydrodynamics.  Chapter 3 of the notes 
summarizes the numerical methods for advection that we implement in pyro:

<div class="pdf"><a href="http://bender.astro.sunysb.edu/hydro_by_example/CompHydroTutorial.pdf">notes on computational hydro</a></div>

<p>In particular, pyro implements a two-dimensional unsplit piecewise
linear advection method.  It follows very closely the outline of
Colella (1990).  The above notes give all the details necessary to follow
the code.

The main parameters that affect this solver are:
<p><table>
<tr><td colspan=2 class="gray"><tt>[driver]</tt></td>
<tr><td><tt>cfl</tt></td>
    <td>the advective CFL number (what fraction of a zone can we cross in
        a single timestep)</td>
</tr>
<tr><td colspan=2 class="gray"><tt>[advection]</tt></td>
<tr><td><tt>u</tt></td>
    <td>the advective velocity in the x direction</td>
</tr>
<tr><td><tt>v</tt></td>
    <td>the advective velocity in the y direction</td>
</tr>
<tr><td><tt>limiter</tt></td>
    <td>what type of limiting to use in reconstructing the slopes.  0 means
        use an unlimited second-order centered difference.  1 is the
        MC limiter, and 2 is the 4th-order MC limiter</td>
</tr>
</table>

<p>The main use for the advection solver is to understand how Godunov
techniques work for hyperbolic problems.  These same ideas will be used
in the compressible and incompressible solvers.  This video shows graphically
how the basic advection algorithm works, consisting of reconstruction,
evolution, and averaging steps:

<p class="center">
<iframe width="640" height="360" src="https://www.youtube.com/embed/Z_yFd5HqOqc?rel=0" frameborder="0" allowfullscreen></iframe>


<p><h2>&lowast; Examples</h2>

<p><h3>smooth</h3>

<p>The smooth problem initializes a Gaussian profile and advects it with
<tt>u = v = 1</tt> through periodic boundaries for a period.  The result
is that the final state should be identical to the initial state&mdash;any
disagreement is our numerical error.  This is run as:

<pre class="code">./pyro.py advection smooth inputs.smooth</pre>

<p class="center">
<iframe width="640" height="480" src="https://www.youtube.com/embed/712Y0ocuz2M?rel=0" frameborder="0" allowfullscreen>
</iframe>


<p>By varying the resolution and comparing to the analytic solution, we
can measure the convergence rate of the method.  The <tt>smooth_error.py</tt>
script in <tt>analysis/</tt> will compare an output file to the analytic 
solution for this problem.

<p class="center"><img src="examples/smooth_converge.png">

<p>The points above are the L2-norm of the absolute error for the
smooth advection problem after 1 period with CFL=0.8.  The dashed line
is perfect 2<sup>nd</sup> order convergence.  We see that we achieve
nearly 2<sup>nd</sup> order convergence.  Departures from perfect
2<sup>nd</sup> order convergence are likely due to the use of
limiters.


<p><h3>tophat</h3>

<p>The tophat problem initializes a circle in the center of the domain
with value 1, and 0 outside.  This has very steep jumps, and the
limiters will kick in strongly here.



<p><h2>&lowast; Exercises</h2>

<p>The best way to learn these methods is to play with them yourself.
The exercises below are suggestions for explorations and features
to add to the advection solver.

<p><h3>Explorations</h3>

<ul>
<li>Test the convergence of the solver for a variety of initial conditions
(tophat hat will differ from the smooth case because of limiting).  Test
with limiting on and off, and also test with the slopes set to 0 (this will
reduce it down to a piecewise constant reconstruction method).
</li>

<li>Run without any limiting and look for oscillations and under and
overshoots (does the advected quantity go negative in the tophat
problem?)</li>

</ul>


<p><h3>Extensions</h3>

<ul>

<li>Implement a dimensionally split version of the advection algorithm.  
    How does the solution compare between the unsplit and split versions?
    Look at the amount of overshoot and undershoot, for example.</li>

<li>Research the inviscid Burger's equation&mdash;this looks like the 
advection equation, but now the quantity being advected is the velocity
itself, so this is a non-linear equation.  It is very straightforward
to modify this solver to solve Burger's equation (the main things that
need to change are the Riemann solver and the fluxes, and the computation
of the timestep).

<p>The neat thing about Burger's equation is that it admits shocks and
rarefactions, so some very interesting flow problems can be setup.</li>

</ul>



</div>  <!-- main -->



<!-- FOOTER ............................................................. -->
<div id="footer">
   <a href="/pyro2/help/">get help</a>&nbsp;|&nbsp;
   <a href="/pyro2/acknowledgments/">acknowledgments</a>&nbsp;|&nbsp;
   <a href="http://www.astro.sunysb.edu/mzingale/">Michael Zingale</a> (Stony Brook) &bull;
</div>



</BODY>
</HTML>



