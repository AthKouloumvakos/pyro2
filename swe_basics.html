

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Shallow water solvers &mdash; pyro 2.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyro 2.1 documentation" href="index.html"/>
        <link rel="next" title="Analysis routines" href="analysis.html"/>
        <link rel="prev" title="Low Mach number hydrodynamics solver" href="lowmach_basics.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyro
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">pyro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh_basics.html">Mesh overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html">Mesh examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Solvers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="advection_basics.html">Advection solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_basics.html">Compressible hydrodynamics solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_compare.html">Compressible solver comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid_basics.html">Multigrid solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-examples.html">Multigrid examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics solver</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Shallow water solvers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-problems">Example problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dam">dam</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quad">quad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kh">kh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">Exercises</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#explorations">Explorations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extensions">Extensions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyro</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Shallow water solvers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/swe_basics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="shallow-water-solvers">
<h1>Shallow water solvers<a class="headerlink" href="#shallow-water-solvers" title="Permalink to this headline">¶</a></h1>
<p>The (augmented) shallow water equations take the form:</p>
<div class="math">
\[\begin{split}\frac{\partial h}{\partial t} + \nabla \cdot (h U) &amp;= 0 \\
\frac{\partial (h U)}{\partial t} + \nabla \cdot (h U U) + \frac{1}{2}g\nabla h^2 &amp;= 0 \\
\frac{\partial (h \psi)}{\partial t} + \nabla \cdot (h U \psi) &amp;= 0\end{split}\]</div>
<p>with <span class="math">\(h\)</span> is the fluid height, <span class="math">\(U\)</span> the fluid velocity, <span class="math">\(g\)</span> the
gravitational acceleration and <span class="math">\(\psi = \psi(x, t)\)</span> represents some
passive scalar.</p>
<p>The implementation here has flattening at shocks and a choice of Riemann solvers.</p>
<p>The main parameters that affect this solver are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2"><code class="docutils literal"><span class="pre">[driver]</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">cfl</span></code></td>
<td>the advective CFL number (what fraction of a zone can
we cross in a single timestep)</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2"><code class="docutils literal"><span class="pre">[swe]</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">use_flattening</span></code></td>
<td>do we flatten the profiles at shocks? (0=no, 1=yes)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">z0</span></code></td>
<td rowspan="3">the parameters that affect the flattening algorithm</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">z1</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">delta</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">limiter</span></code></td>
<td>what type of limiting to use in reconstructing the
slopes. 0 means use an unlimited second-order centered
difference. 1 is the MC limiter, and 2 is the 4th-order
MC limiter</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">riemann</span></code></td>
<td>which Riemann solver do we use? “HLLC” for the HLLC
solver, or “Roe” for the Roe fix
solver</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">grav</span></code></td>
<td>the gravitational acceleration (must be &gt; 0)</td>
</tr>
</tbody>
</table>
<div class="section" id="example-problems">
<h2>Example problems<a class="headerlink" href="#example-problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dam">
<h3>dam<a class="headerlink" href="#dam" title="Permalink to this headline">¶</a></h3>
<p>The dam break problem is a standard hydrodynamics problem, analagous to the Sod
shock tube problem in compressible hydrodynamics. It considers a one-multidimensional
problem of two regions of fluid at different heights, initially separated by a dam.
The problem then models the evolution of the system when this dam is removed.
As for the Sod problem, there exists an exact solution for the dam break probem,
so we can check our solution against the exact solutions. See Toro’s shallow water
equations book for details on this problem and the exact Riemann solver.</p>
<p>Because it is one-dimensional, we run it in narrow domains in the x- or
y-directions. It can be run as:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>./pyro.py swe dam inputs.dam.x
./pyro.py swe dam inputs.dam.y
</pre></div>
</div>
<p>A simple script, <code class="docutils literal"><span class="pre">dam_compare.py</span></code> in <code class="docutils literal"><span class="pre">analysis/</span></code> will read a pyro output
file and plot the solution over the exact dam break solution (as given by
<a class="reference external" href="https://doi.org/10.1063/1.3062689">Stoker (1958)</a> and
<a class="reference external" href="https://doi.org/10.1061/(ASCE)0733-9429(1999)125:11(1210)">Wu, Huang &amp; Zheng (1999)</a>). Below we see
the result for a dam break run with 128 points in the x-direction, and run
until t = 0.3 s.</p>
<img alt="_images/dam_compare.png" class="align-center" src="_images/dam_compare.png" />
<p>We see excellent agreement for all quantities. The shock wave is very
steep, as expected. For this problem, the Roe-fix solver performs
slightly better than the HLLC solver, with less smearing at the shock
and head/tail of the rarefaction.</p>
</div>
<div class="section" id="quad">
<h3>quad<a class="headerlink" href="#quad" title="Permalink to this headline">¶</a></h3>
<p>The quad problem sets up different states in four regions of the
domain and watches the complex interfaces that develop as shocks
interact. This problem has appeared in several places (and a <a class="reference external" href="http://planets.utsc.utoronto.ca/~pawel/Riemann.hydro.html">detailed
investigation</a> is
online by Pawel Artymowicz). It is run as:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>./pyro.py swe quad inputs.quad
</pre></div>
</div>
</div>
<div class="section" id="kh">
<h3>kh<a class="headerlink" href="#kh" title="Permalink to this headline">¶</a></h3>
<p>The Kelvin-Helmholtz problem models three layers of fluid: two at the top and
bottom of the domain travelling in one direction, one in the central part of the
domain travelling in the opposite direction. At the interface of the layers,
shearing produces the characteristic Kelvin-Helmholtz instabilities, just as
is seen in the standard compressible problem. It is run as:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>./pyro.py swe kh inputs.kh
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="explorations">
<h3>Explorations<a class="headerlink" href="#explorations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>There are multiple Riemann solvers in the swe
algorithm. Run the same problem with the different Riemann solvers
and look at the differences. Toro’s shallow water text is a good book to help
understand what is happening.</li>
<li>Run the problems with and without limiting—do you notice any overshoots?</li>
</ul>
</div>
<div class="section" id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Limit on the characteristic variables instead of the primitive
variables. What changes do you see? (the notes show how to implement
this change.)</li>
<li>Add a source term to model a non-flat sea floor (bathymetry).</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="analysis.html" class="btn btn-neutral float-right" title="Analysis routines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lowmach_basics.html" class="btn btn-neutral" title="Low Mach number hydrodynamics solver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Michael Zingale.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>