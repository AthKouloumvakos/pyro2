<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>
<HEAD>
  <TITLE>pyro: compressible solver</TITLE> 

  <link rel="stylesheet" type="text/css" href="../hydro.css">
  <link rel="stylesheet" type="text/css" href="./comp.css">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">

</HEAD> 

<body id="compressible">

<!-- HEADER .............................................................. -->
<!-- to do highlighting:

http://hicksdesign.co.uk/journal/highlighting-current-page-with-css

http://www.richnetapps.com/automatically_highlight_current_page_in/

-->


<div id="header2">
  <h1>hydro by example</h1><br>
  <h3>A simple python-based tutorial on computational methods for hydrodynamics</h3>
</div>

<div id="subhead">
  <h2><a href="/pyro2/index.html" id="intronav">intro</a></h2> &bull;
  <h2><a href="/pyro2/design" id="designnav">design</a></h2> &bull;
  <h2><a href="/pyro2/grids" id="gridnav">grids</a></h2> &bull;
  <h2><a href="/pyro2/advection" id="advectnav">advection</a></h2> &bull;
  <h2><a href="/pyro2/compressible" id="compnav">compressible</a></h2> &bull;
  <h2><a href="/pyro2/multigrid" id="mgnav">multigrid</a></h2> &bull;
  <h2><a href="/pyro2/diffusion" id="diffnav">diffusion</a></h2> &bull;
  <h2><a href="/pyro2/incompressible" id="incompnav">incompressible</a></h2> &bull;
  <h2><a href="/pyro2/lm_atm" id="lmatmnav">low Mach</a></h2>  &nbsp;|&nbsp;

  <h2><a href="/pyro2/analysis" id="annav">analysis</a></h2> &nbsp;|&nbsp;

  <h2><a href="/pyro2/download" id="dlnav">download</a></h2> 

</div>




<!-- MAIN ................................................................ -->
<div id="main">


<P><H2>&lowast; Compressible hydrodynamics solver</H2>

<p>pyro's compressible solver is based on a directionally unsplit
piecewise linear method for the Euler equations.  The basic theory is
outlined in Chapter 5 of the notes:

<div class="pdf"><a href="../CompHydroTutorial.pdf">notes on computational hydro</a></div>

<p>The implementation here has flattening at shocks, artificial viscosity,
a simple gamma-law equation of state, and two different Riemann solvers.
Optional constant gravity in the vertical direction is allowed.

<p>The main parameters that affect this solver are:
<p><table>
<tr><td colspan=2 class="gray"><tt>[driver]</tt></td>

<tr><td><tt>cfl</tt></td>
    <td>the advective CFL number (what fraction of a zone can we cross in
        a single timestep)</td>
</tr>


<tr><td colspan=2 class="gray"><tt>[compressible]</tt></td>

<tr><td><tt>use_flattening</tt></td>
    <td>do we flatten the profiles at shocks? (0=no, 1=yes)</td>
</tr>

<tr><td><tt>z0</tt>, <tt>z1</tt>, <tt>delta</tt></td>
    <td>the parameters that affect the flattening algorithm</td>
</tr>

<tr><td><tt>cvisc</tt></td>
    <td>the coefficient for the artifical viscosity</td>
</tr>

<tr><td><tt>limiter</tt></td>
    <td>what type of limiting to use in reconstructing the slopes.  0 means
        use an unlimited second-order centered difference.  1 is the
        MC limiter, and 2 is the 4th-order MC limiter</td>
</tr>

<tr><td><tt>riemann</tt></td>
    <td>which Riemann solver do we use? "HLLE" for the HLLE solver, or 
        "CGF" for the Colella, Glaz, and Ferguson solver</td>
</tr>

<tr><td><tt>grav</tt></td>
    <td>the gravitational acceleration (vertical/y direction)</td>
</tr>


<tr><td colspan=2 class="gray"><tt>[eos]</tt></td>

<tr><td><tt>gamma</tt></td>
    <td>the constant adiabatic index for the gas</td>
</tr>

</table>


<P><H2>&lowast; Examples</H2>

<p><h3>Sod</h3>

<p>The Sod problem is a standard hydrodynamics problem.  It is a
one-dimensional shock tube (two states separated by an interface),
that exhibits all three hydrodynamic waves: a shock, contact, and
rarefaction.  Furthermore, there are exact solutions for a gamma-law
equation of state, so we can check our solution against these
exact solutions.  See Toro's book for details on this problem and the
exact Riemann solver.

<p>Because it is one-dimensional, we run it in narrow domains in the 
x- or y-directions.  It can be run as:

<pre class="code">./pyro.py compressible sod inputs.sod.x
./pyro.py compressible sod inputs.sod.y</pre>

<p>A simple script, <tt>sod_compare.py</tt> in <tt>analysis/</tt>
will read a pyro output file and plot the solution over the exact Sod
solution.  Below we see the result for a Sod run with 128 points in the
x-direction, gamma = 1.4, and run until t = 0.2 s.

<p class="center"><img src="examples/sod_compare.png">

<p>We see excellent agreement for all quantities.  The shock wave is
very steep, as expected.  The contact wave is smeared out over ~5
zones&mdash;this is discussed in the notes above, and can be improved
in the PPM method with contact steepening.

<p><h3>Sedov</h3>

<p>The Sedov blast wave problem is another standard test with an
analytic solution (Sedov 1959).  A lot of energy is point into a
point in a uniform medium and a blast wave propagates outward.  The
Sedov problem is run as:

<pre class="code">./pyro.py compressible sedov inputs.sedov</pre>

<p>The image below shows the output from a 128 x 128 grid with the 
energy put in a radius of 0.0125 surrounding the center of the 
domain.  A gamma-law EOS with gamma = 1.4 is used, and we run until
0.1

<p class="center">
<iframe width="640" height="480" src="http://www.youtube.com/embed/1JO6By78p9E?rel=0" frameborder="0" allowfullscreen>
<img src="examples/sedov.png">
</iframe>


<p>We see some grid effects because it is hard to initialize a
small circular explosion on a rectangular grid.  To compare
to the analytic solution, we need to radially bin the data.
Since this is a 2-d explosion, the physical geometry it 
represents is a cylindrical blast wave, so we compare to Sedov's
cylindrical solution.  The radial binning is done with the
<tt>sedov_compare.py</tt> script in <tt>analysis/</tt>

<p class="center"><img src="examples/sedov_compare.png">

<p>This shows good agreement with the analytic solution.  


<p><h3>quad</h3>

<p>The quad problem sets up different states in four regions of the
domain and watches the complex interfaces that develop as shocks
interact.  This problem has appear in several places (and
a <a href="http://planets.utsc.utoronto.ca/~pawel/Riemann.hydro.html">detailed
investigation</a> is online by Pawel Artymowicz).  It is run as:

<pre class="code">./pyro.py compressible quad inputs.quad</pre>

<p class="center"><img src="examples/quad.png">

<p><h3>rt</h3>

<p>The Rayleigh-Taylor problem puts a dense fluid over a lighter one 
and perturbs the interface with a sinusoidal velocity.  Hydrostatic
boundary conditions are used to ensure any initial pressure waves
can escape the domain.  It is run as:

<pre class="code">./pyro.py compressible er inputs.rt</pre>

<p class="center">
<iframe width="640" height="360" src="http://www.youtube.com/embed/P4zmObEYCOs?rel=0" frameborder="0" allowfullscreen>
<img src="examples/rt.png">
</iframe>


<p><h3>bubble</h3>

<p>The bubble problem initializes a hot spot in a stratified domain and
watches it buoyantly rise and roll up.  This is run as:

<pre class="code">./pyro.py compressible bubble inputs.bubble</pre>

<p class="center"><img src="examples/bubble.png">

<p>The shock at the top of the domain is because we cut off the
stratified atmosphere at some low density and the resulting material
above that rains down on our atmosphere.  Also note the acoustic
signal propagating outward from the bubble (visible in the U and e
panels).


<p><h2>&lowast; Exercises</h2>

<p><h3>Explorations</h3>

<ul>
<li>Measure the growth rate of the Rayleigh-Taylor instability for different
    wavenumbers.
</li>

<li>There are multiple Riemann solvers in the compressible algorithm.
  Run the same problem with the different Riemann solvers and look
  at the differences.  Toro's text is a good book to help understand
  what is happening.
</li>

<li>Run the problems with and without limiting&mdash;do you notice any
  overshoots?
</li>
</ul>


<p><h3>Extensions</h3>

<ul>
<li>Limit on the characteristic variables instead of the primitive variables.  
  What changes do you see?  (the notes show how to implement this change.)

<li>Add passively advected species to the solver.</li>

<li>Add an external heating term to the equations.</li>

<li>Add 2-d axisymmetric coordinates (r-z) to the solver.  This is discussed
  in the notes.  Run the Sedov problem with the explosion on the symmetric
  axis&mdash;now the solution will behave like the spherical sedov explosion
  instead of the cylindrical explosion.

<li>Swap the piecewise linear reconstruction for piecewise parabolic
 (PPM).  The notes and Miller and Colella paper provide a good 
 basis for this.</li>

<li>Research the Roe Riemann solver and implement it in pyro.</li>

</ul>


<p><h2>&lowast; Going further</h2>

<p>The compressible algorithm presented here is essentially the
single-grid hydrodynamics algorithm used in
the <a href="https://ccse.lbl.gov/Research/CASTRO/index.html">Castro</a>
code&mdash;an adaptive mesh radiation hydrodynamics code developed
at CCSE/LBNL.  Castro
is <a href="https://ccse.lbl.gov/Downloads/downloadCASTRO.html">freely
available for download</a>.

<p>A simple, pure Fortran, 1-d compressible hydrodynamics code that
does piecewise constant, linear, or parabolic (PPM) reconstruction
is also available.  See the <a href="http://bender.astro.sunysb.edu/hydro1d/">hydro1d page</a>.

</div>  <!-- main -->



<!-- FOOTER .............................................................. -->
<div id="footer">
   <a href="/pyro2/help/">get help</a>&nbsp;|&nbsp;
   <a href="/pyro2/acknowledgments/">acknowledgments</a>&nbsp;|&nbsp;
   <a href="http://www.astro.sunysb.edu/mzingale/">Michael Zingale</a> (Stony Brook) &bull;
</div>



</BODY>
</HTML>



