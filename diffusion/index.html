<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>
<HEAD>
  <TITLE>pyro: diffusion</TITLE> 

  <link rel="stylesheet" type="text/css" href="../hydro.css">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">

</HEAD> 

<body id="diffusion">

<!-- HEADER .............................................................. -->
<!-- to do highlighting:

http://hicksdesign.co.uk/journal/highlighting-current-page-with-css

http://www.richnetapps.com/automatically_highlight_current_page_in/

-->


<div id="header2">
  <h1>hydro by example</h1><br>
  <h3>A simple python-based tutorial on computational methods for hydrodynamics</h3>
</div>

<div id="subhead">
  <h2><a href="/pyro2/index.html" id="intronav">intro</a></h2> &bull;
  <h2><a href="/pyro2/design" id="designnav">design</a></h2> &bull;
  <h2><a href="/pyro2/grids" id="gridnav">grids</a></h2> &bull;
  <h2><a href="/pyro2/advection" id="advectnav">advection</a></h2> &bull;
  <h2><a href="/pyro2/compressible" id="compnav">compressible</a></h2> &bull;
  <h2><a href="/pyro2/multigrid" id="mgnav">multigrid</a></h2> &bull;
  <h2><a href="/pyro2/diffusion" id="diffnav">diffusion</a></h2> &bull;
  <h2><a href="/pyro2/incompressible" id="incompnav">incompressible</a></h2> &bull;
  <h2><a href="/pyro2/lm_atm" id="lmatmnav">low Mach</a></h2>  &nbsp;|&nbsp;

  <h2><a href="/pyro2/analysis" id="annav">analysis</a></h2> &nbsp;|&nbsp;

  <h2><a href="/pyro2/download" id="dlnav">download</a></h2> 

</div>




<!-- MAIN ................................................................ -->
<div id="main">


<P><H2>&lowast; Diffusion</H2>

<p>pyro solves the constant-conductivity diffusion equation implicitly
using multigrid.  Chapter 7 of the notes below summarize the methodology:

<div class="pdf"><a href="http://bender.astro.sunysb.edu/hydro_by_example/CompHydroTutorial.pdf">notes on computational hydro</a></div>


<p>The diffusion equation is discretized using
Crank-Nicolson differencing (this makes the diffusion operator
time-centered) and the implicit discretization forms a Helmholtz
equation solved by the pyro multigrid class.

The main parameters that affect this solver are:

<p><table>
<tr><td colspan=2 class="gray"><tt>[driver]</tt></td>
<tr><td><tt>cfl</tt></td>
    <td>the "CFL" number for the diffusion equation.  Since we are 
        doing an implicit discretization, this is the multiple of the
        explicit timestep to take.)</td>
</tr>
<tr><td colspan=2 class="gray"><tt>[diffusion]</tt></td>
<tr><td><tt>k</tt></td>
    <td>the conductivity (constant)</td>
</tr>
</table>



<p><h2>&lowast; Examples</h2>

<p><h3>gaussian</h3>

<p>The gaussian problem initializes a strongly peaked Gaussian centered
in the domain.  The analytic solution for this shows that the profile
remains a Gaussian, with a changing width and peak.  This allows us
to compare our solver to the analytic solution.  This is run as:

<pre class="code">./pyro.py diffusion gaussian inputs.gaussian</pre>

<p class="center"><img src="examples/gauss_diffusion.png">

<p>The above figure shows the scalar field after diffusing
significantly from its initial strongly peaked state.  We can compare
to the analytic solution by making radial profiles of the scalar.  The
plot below shows the numerical solution (red points) overplotted on
the analytic solution (solid curves) for several different times.  The
y-axis is restricted in range to bring out the detail at later times.

<p class="center"><img src="examples/gauss_diffusion_compare.png">

<p><h2>&lowast; Exercises</h2>

<p>The best way to learn these methods is to play with them yourself.
The exercises below are suggestions for explorations and features
to add to the advection solver.

<p><h3>Explorations</h3>

<ul>
<li>Test the convergence of the solver by varying the resolution
and comparing to the analytic solution.
</li>

<li>How does the solution error change as the CFL number is increased
well above 1?
</li>

<li>Setup some other profiles and experiment with different boundary
conditions.</li>

</ul>


<p><h3>Extensions</h3>

<ul>

<li>Switch from Crank-Nicolson (2<sup>nd</sup> order in time) to backward's
Euler (1<sup>st</sup> order in time) and compare the solution and 
convergence.  This should only require changing the source term and
coefficents used in setting up the multigrid solve.  It does not
require changes to the multigrid solver itself.</li>


<li>Implement a non-constant coefficient diffusion solver&mdash;note: this will
require improving the multigrid solver.</li>

</ul>


</div>  <!-- main -->



<!-- FOOTER .............................................................. -->
<div id="footer">
   <a href="/pyro2/help/">get help</a>&nbsp;|&nbsp;
   <a href="/pyro2/acknowledgments/">acknowledgments</a>&nbsp;|&nbsp;
   <a href="http://www.astro.sunysb.edu/mzingale/">Michael Zingale</a> (Stony Brook) &bull;
</div>



</BODY>
</HTML>



