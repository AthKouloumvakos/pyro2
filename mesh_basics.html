

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mesh overview &mdash; pyro 2.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyro 2.1 documentation" href="index.html"/>
        <link rel="next" title="Mesh examples" href="mesh-examples.html"/>
        <link rel="prev" title="Adding a problem" href="problems.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyro
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">pyro basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mesh overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mesh-patch-implementation-and-use"><code class="docutils literal"><span class="pre">mesh.patch</span></code> implementation and use</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jupyter-notebook">Jupyter notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests">Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html">Mesh examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advection_basics.html">Advection solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_basics.html">Compressible hydrodynamics solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_compare.html">Compressible solver comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid_basics.html">Multigrid solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-examples.html">Multigrid examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics solver</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="help.html">Getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyro</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Mesh overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mesh_basics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="mesh-overview">
<h1>Mesh overview<a class="headerlink" href="#mesh-overview" title="Permalink to this headline">¶</a></h1>
<p>All solvers are based on a finite-volume/cell-centered
discretization. The basic theory of such methods is discussed in
<a class="reference internal" href="notes.html#notes"><span class="std std-ref">Notes on the numerical methods</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The core data structure that holds data on the grid is
<a class="reference internal" href="mesh.html#mesh.patch.CellCenterData2d" title="mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal"><span class="pre">CellCenterData2d</span></code></a>.  This does
not distinguish between cell-centered data and cell-averages.  This
is fine for methods that are second-order accurate, but for
higher-order methods, the <a class="reference internal" href="mesh.html#mesh.fv.FV2d" title="mesh.fv.FV2d"><code class="xref py py-func docutils literal"><span class="pre">FV2d</span></code></a> class has
methods for converting between the two data centerings.</p>
</div>
<div class="section" id="mesh-patch-implementation-and-use">
<h2><code class="docutils literal"><span class="pre">mesh.patch</span></code> implementation and use<a class="headerlink" href="#mesh-patch-implementation-and-use" title="Permalink to this headline">¶</a></h2>
<p>We import the basic mesh functionality as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mesh.patch</span> <span class="kn">as</span> <span class="nn">patch</span>
<span class="kn">import</span> <span class="nn">mesh.fv</span> <span class="kn">as</span> <span class="nn">fv</span>
<span class="kn">import</span> <span class="nn">mesh.boundary</span> <span class="kn">as</span> <span class="nn">bnd</span>
<span class="kn">import</span> <span class="nn">mesh.array_indexer</span> <span class="kn">as</span> <span class="nn">ai</span>
</pre></div>
</div>
<p>There are several main objects in the patch class that we interact with:</p>
<ul class="simple">
<li><a class="reference internal" href="mesh.html#mesh.patch.Grid2d" title="mesh.patch.Grid2d"><code class="xref py py-func docutils literal"><span class="pre">patch.Grid2d</span></code></a>: this is the main grid
object. It is basically a container that holds the number of zones
in each coordinate direction, the domain extrema, and the
coordinates of the zones themselves (both at the edges and center).</li>
<li><a class="reference internal" href="mesh.html#mesh.patch.CellCenterData2d" title="mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal"><span class="pre">patch.CellCenterData2d</span></code></a>: this
is the main data object—it holds cell-centered data on a grid.  To
build a <code class="docutils literal"><span class="pre">CellCenterData2d</span></code> object you need to pass in the <code class="docutils literal"><span class="pre">Grid2d</span></code>
object that defines the mesh. The <code class="docutils literal"><span class="pre">CellCenterData2d</span></code> object then
allocates storage for the unknowns that live on the grid. This class
also provides methods to fill boundary conditions, retrieve the data
in different fashions, and read and write the object from/to disk.</li>
<li><a class="reference internal" href="mesh.html#mesh.fv.FV2d" title="mesh.fv.FV2d"><code class="xref py py-func docutils literal"><span class="pre">fv.FV2d</span></code></a>: this is a special class derived from
<code class="docutils literal"><span class="pre">patch.CellCenterData2d</span></code> that implements some extra functions
needed to convert between cell-center data and averages with
fourth-order accuracy.</li>
<li><a class="reference internal" href="mesh.html#mesh.boundary.BC" title="mesh.boundary.BC"><code class="xref py py-func docutils literal"><span class="pre">bnd.BC</span></code></a>: This is simply a container that
holds the names of the boundary conditions on each edge of the
domain.</li>
<li><a class="reference internal" href="mesh.html#mesh.array_indexer.ArrayIndexer" title="mesh.array_indexer.ArrayIndexer"><code class="xref py py-func docutils literal"><span class="pre">ai.ArrayIndexer</span></code></a>: This is a
class that subclasses the NumPy ndarray and makes the data in the
array know about the details of the grid it is defined on. In
particular, it knows which cells are valid and which are the ghost
cells, and it has methods to do the <span class="math">\(a_{i+1,j}\)</span> operations that are
common in difference methods.</li>
<li><a class="reference internal" href="mesh.html#mesh.integration.RKIntegrator" title="mesh.integration.RKIntegrator"><code class="xref py py-func docutils literal"><span class="pre">integration.RKIntegrator</span></code></a>:
This class implements Runge-Kutta integration in time by managing a
hierarchy of grids at different time-levels.  A Butcher tableau
provides the weights and evaluation points for the different stages
that make up the integration.</li>
</ul>
<p>The procedure for setting up a grid and the data that lives on it is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">myg</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">Grid2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates the 2-d grid object <code class="docutils literal"><span class="pre">myg</span></code> with 16 zones in the x-direction
and 32 zones in the y-direction. It also specifies the physical
coordinate of the rightmost edge in x and y.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mydata</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">CellCenterData2d</span><span class="p">(</span><span class="n">myg</span><span class="p">)</span>

<span class="n">bc</span> <span class="o">=</span> <span class="n">bnd</span><span class="o">.</span><span class="n">BC</span><span class="p">(</span><span class="n">xlb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">xrb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">ylb</span><span class="o">=</span><span class="s2">&quot;reflect-even&quot;</span><span class="p">,</span> <span class="n">yrb</span><span class="o">=</span><span class="s2">&quot;outflow&quot;</span><span class="p">)</span>

<span class="n">mydata</span><span class="o">.</span><span class="n">register_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<span class="n">mydata</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</div>
<p>This creates the cell-centered data object, <code class="docutils literal"><span class="pre">mydata</span></code>, that lives on the
grid we just built above. Next we create a boundary condition object,
specifying the type of boundary conditions for each edge of the
domain, and finally use this to register a variable, <code class="docutils literal"><span class="pre">a</span></code> that lives on
the grid. Once we call the <code class="docutils literal"><span class="pre">create()</span></code> method, the storage for the
variables is allocated and we can no longer add variables to the grid.
Note that each variable needs to specify a BC—this allows us to do
different actions for each variable (for example, some may do even
reflection while others may do odd reflection).</p>
</div>
<div class="section" id="jupyter-notebook">
<h2>Jupyter notebook<a class="headerlink" href="#jupyter-notebook" title="Permalink to this headline">¶</a></h2>
<p>A Jupyter notebook that illustrates some of the basics of working with
the grid is provided as <a class="reference internal" href="mesh-examples.html"><span class="std std-ref">Mesh examples</span></a>. This will
demonstrate, for example, how to use the <code class="docutils literal"><span class="pre">ArrayIndexer</span></code> methods to
construct differences.</p>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2>
<p>The actual filling of the boundary conditions is done by the <code class="docutils literal"><span class="pre">fill_BC()</span></code>
method. The script <code class="docutils literal"><span class="pre">bc_demo.py</span></code> tests the various types of boundary
conditions by initializing a small grid with sequential data, filling
the BCs, and printing out the results.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mesh-examples.html" class="btn btn-neutral float-right" title="Mesh examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="problems.html" class="btn btn-neutral" title="Adding a problem" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Michael Zingale.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>